<!-- version: 2025-10-03 | Hanyang Intercollege FAQ (no copy buttons/icons) -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hanyang Intercollege 전공선택 관련 FAQ</title>
  <meta name="description" content="2025학번 한양인터칼리지 전공선택·졸업요건 정적 FAQ 검색기" />
  <link rel="icon" type="image/png" href="assets/hyuic.png"/>

  <style>
    /* ===== Navy Theme ===== */
    :root{
      --bg:#0a1428; --panel:#0f1b33; --panel-2:#0c172b;
      --muted:#aab7d0; --text:#f1f5ff;
      --brand:#2a4db3; --brand-2:#1b3b91;
      --chip:#122449; --chip-on:#17356e;
      --ok:#3ddc97; --radius:16px;
      --shadow:0 10px 36px rgba(5,10,25,.35);
      --hl: rgba(64,129,255,.25);
    }
    @media (prefers-color-scheme:light){
      :root{
        --bg:#eef2ff; --panel:#ffffff; --panel-2:#f4f7ff;
        --muted:#4b5563; --text:#0b1020;
        --brand:#2a4db3; --brand-2:#203a8c;
        --chip:#eaf0ff; --chip-on:#d8e3ff;
        --shadow:0 10px 26px rgba(15,24,48,.10);
        --hl: rgba(37,99,235,.18);
      }
    }
    *{box-sizing:border-box}
    body{margin:0;font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,sans-serif;background:
      radial-gradient(1000px 420px at 10% -10%, rgba(42,77,179,.25), transparent 60%),
      radial-gradient(900px 380px at 100% 10%, rgba(27,59,145,.20), transparent 60%),
      linear-gradient(180deg, var(--bg), #081024 55%);color:var(--text);}
    .wrap{max-width:1060px;margin:40px auto;padding:0 20px;}

    /* HERO */
    .hero{display:grid;grid-template-columns:1fr minmax(200px,280px);gap:18px;
      background:linear-gradient(180deg,var(--panel),var(--panel-2) 80%);
      padding:24px;border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,.06);}
    .brandbox{display:flex;align-items:center;gap:16px;flex-wrap:wrap;margin-bottom:6px;}
    .logo{width:160px;height:auto;background:none;border:0;}
    .logo img{width:100%;height:auto;display:block;}
    .hero h1{margin:0;font-size:clamp(22px,3.2vw,34px)}
    .hero p{margin:4px 0 0;color:var(--muted)}
    .hero-illus{display:flex;align-items:center;justify-content:center;border-radius:14px;
      background:radial-gradient(140px 120px at 40% 40%,rgba(126,164,255,.15),transparent 70%);}
    .hero-illus img{width:100%;max-width:240px;height:auto;object-fit:contain;display:block;
      filter:drop-shadow(0 8px 20px rgba(0,0,0,.3));}

    /* Controls */
    .searchbar{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap;}
    .btn{padding:12px 16px;border-radius:12px;border:0;cursor:pointer;
      background:linear-gradient(135deg,var(--brand),var(--brand-2));color:white;font-weight:600;box-shadow:var(--shadow);}
    .toolbar{margin-top:12px;display:flex;flex-wrap:wrap;gap:8px;align-items:center;}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:var(--chip);
      border:1px solid rgba(255,255,255,.08);color:var(--text);cursor:pointer;font-size:14px;}
    .chip[data-on="true"]{background:var(--chip-on);border-color:rgba(64,129,255,.45)}

    /* List */
    .panel{margin-top:24px;background:var(--panel);border-radius:var(--radius);border:1px solid rgba(255,255,255,.08);box-shadow:var(--shadow);}
    .meta{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-bottom:1px dashed rgba(255,255,255,.12);color:var(--muted);font-size:14px;}
    .results{padding:10px 14px 6px;}
    .card{border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px;margin:12px 6px;background:linear-gradient(180deg,rgba(255,255,255,.02),transparent 60%);}
    .qline{display:flex;gap:10px;align-items:flex-start;}
    .qline h3{margin:0;font-size:18px;line-height:1.35;cursor:pointer;}
    .badge{font-size:12px;font-weight:700;color:#fff;background:linear-gradient(135deg,var(--brand),var(--brand-2));padding:4px 8px;border-radius:999px;}
    .answer{margin-top:10px;color:var(--text);line-height:1.65}
    .answer .hl{background:transparent;box-shadow:inset 0 -0.35em 0 var(--hl);}
    .tags{margin-top:10px;display:flex;flex-wrap:wrap;gap:6px}
    .tag{font-size:12px;color:#bcd0ff;background:rgba(22,42,92,.6);padding:4px 8px;border-radius:999px;}
    .footer{margin:20px 0 60px;color:#b1badd;font-size:13px;text-align:center;}

    /* 숨김/블러 + 아코디언 */
    .card .reveal{margin-left:auto;font-size:13px;cursor:pointer;color:#7ea4ff;}
    .card .veil{display:none;}
    .card[data-blur="true"] .veil{display:inline-flex;margin-left:auto;font-size:13px;cursor:pointer;color:#7ea4ff;}
    .card[data-collapsed="true"] .answer{max-height:0;overflow:hidden;transition:max-height .25s ease;}

    /* Search Input always white */
    .searchbar input[type="search"]{flex:1;min-width:240px;padding:14px 16px;border-radius:12px;
      background:#fff !important;color:#0b1020 !important;caret-color:#0b1020;
      border:1px solid rgba(0,0,0,.15) !important;}
    .searchbar input[type="search"]::placeholder{color:#6b7280;}
    .searchbar input[type="search"]:focus{border-color:#2a4db3 !important;box-shadow:0 0 0 3px rgba(42,77,179,.25);}
  </style>
</head>
<body>
  <div class="wrap">
    <section class="hero">
      <div>
        <div class="brandbox">
          <div class="logo"><img src="assets/hyuic.png" alt="Hanyang Intercollege 로고"></div>
          <span style="color:#bcd0ff;font-weight:600">전공선택 FAQ</span>
        </div>
        <h1>Hanyang Intercollege 전공선택 관련 FAQ</h1>
        <p>전공 선택 · 다(부)전공 · MSC · 전공기초필수 · 프로젝트 · 졸업요건 등 핵심 질의응답을 검색하세요.</p>
        <form id="searchForm" class="searchbar">
          <input id="q" type="search" placeholder="예) 전공기초필수, MSC 전공학점, 주전공 변경" autocomplete="off"/>
          <button id="searchBtn" class="btn" type="submit">검색</button>
          <button id="clearBtn" class="btn" type="button">지우기</button>
          <!-- 링크 복사 버튼 제거됨 -->
        </form>
        <div id="tagBar" class="toolbar"></div>
        <div class="toolbar" id="privacyBar">
          <label class="chip"><input id="hideToggle" type="checkbox" style="accent-color:var(--brand);margin-right:6px"/>답변 숨김 모드</label>
        </div>
      </div>
      <div class="hero-illus">
        <img src="assets/intercollege-hero.png" alt="Intercollege 캐릭터">
      </div>
    </section>

    <section class="panel">
      <div class="meta"><div><span id="count">0</span>건 결과</div><div>정확도순</div></div>
      <div id="results" class="results"></div>
    </section>

    <p class="footer">출처: 2025학번 한양인터칼리지 FAQ/안내. 최종 기준은 학교 공식 공지사항입니다.</p>
  </div>

  <script>
    /* =========================
       FAQ 데이터 (네가 올린 버전 그대로 사용)
       ========================= */
    const faqData = [
      {id:"1", q:"한양인터칼리지 주전공 시 프로젝트 이수 요건은?", a:"1·2·3·4학년 프로젝트를 모두 이수합니다. 2·3학년 프로젝트는 한양인터칼리지 전공학점으로 인정됩니다.", kw:["주전공","프로젝트","2학년","3학년","전공학점"], tags:["#주전공","#프로젝트","#전공학점"]},
      {id:"2", q:"타 단과대학 주전공 시 프로젝트 이수 요건은?", a:"1학년(3학점), 4학년(12학점) 프로젝트만 필수입니다. 2·3학년 프로젝트는 필수가 아니며 장학 대상에서 제외됩니다.", kw:["타과","프로젝트","1학년","4학년","장학"], tags:["#프로젝트","#주전공","#장학"]},
      {id:"3", q:"한양인터칼리지 주전공의 2·3학년 프로젝트 학점 반영은?", a:"각 3학점이며 전공학점에 포함됩니다.", kw:["2학년","3학년","전공학점","프로젝트"], tags:["#프로젝트","#전공학점"]},
      {id:"4", q:"타과 주전공은 2·3학년 프로젝트 수강 가능?", a:"필수는 아니며, 다전공으로 해당 과목을 수강해 학점 취득은 가능하나 프로젝트 장학금은 제외됩니다.", kw:["다전공","프로젝트","장학","수강"], tags:["#프로젝트","#장학"]},
      {id:"5", q:"프로젝트 장학금 지급 조건은?", a:"한양인터칼리지 2·3학년 프로젝트 이수를 조건으로 지급됩니다. 타과 주전공자는 대상에서 제외됩니다.", kw:["프로젝트 장학금","장학","이수 조건"], tags:["#장학","#프로젝트"]},
      {id:"6", q:"한양인터칼리지 주전공의 1학년 프로젝트 위치는?", a:"1학년 프로젝트(전공핵심 3학점)는 필수입니다. 전공학점 포함 여부는 주전공 유형에 따라 상이합니다.", kw:["1학년 프로젝트","전공핵심","3학점"], tags:["#프로젝트"]},
      {id:"7", q:"타과 주전공의 1·4학년 프로젝트 반영은?", a:"1학년 3학점·4학년 12학점 필수 이수, 전공학점에는 미포함(총졸업학점 반영).", kw:["타과","1학년","4학년","프로젝트"], tags:["#프로젝트"]},
      {id:"8", q:"한양인터칼리지 주전공의 2·3학년 프로젝트 위치는?", a:"각 3학점, 전공학점으로 포함됩니다.", kw:["2학년","3학년","프로젝트","전공학점"], tags:["#프로젝트","#전공학점"]},

      {id:"9",  q:"MSC가 아닌 전공기초필수 과목은 전공학점 인정?", a:"네. 주전공으로 선택한 학부(과)에 개설된 기초과학이 아닌 전공기초필수 과목은 주전공 전공학점(48학점)에 포함됩니다.", kw:["전공기초필수","전공학점","48학점","MSC 아님"], tags:["#전공기초필수","#전공학점"]},
      {id:"10", q:"전공기초필수를 모두 이수해야 졸업 가능?", a:"네, 주전공으로 선택한 학부(과)에 개설된 2~4학년 전공기초필수 교과목은 모두 이수해야 졸업자격을 갖춥니다. 1학년 전공기초필수는 필수는 아니지만 이수 시 전공학점(48학점)에 포함됩니다.", kw:["전공기초필수","졸업요건","2~4학년","1학년","전공학점","48학점","주전공"], tags:["#전공기초필수","#졸업요건","#주전공"]},
      {id:"11", q:"타과 주전공 선택 시 1학년 전공기초필수 면제?", a:"네. 1학년 전공기초필수는 면제되고, 1학년 필수는 한양인터칼리지 지정 교양필수로 충족합니다.", kw:["타과","전공기초필수","면제","교양필수"], tags:["#전공기초필수","#교양필수"]},
      {id:"12", q:"선형대수·공업수학 같은 과목의 이수구분은?", a:"해당 전공의 전공기초필수(2~4학년)로 편성되며 주전공 전공학점(48학점)에 포함됩니다.", kw:["선형대수","공업수학","전공기초필수","48학점"], tags:["#전공기초필수","#전공학점"]},
      {id:"13", q:"예시) 융합전자공학부 주전공 선택 시 유의점?", a:"1학년 전공기초필수는 면제되지만 MSC 과목은 전공학점 미인정. 2~4학년 전공기초필수(선형대수·공업수학1·2 등)는 필수.", kw:["융합전자공학부","MSC","선형대수","공업수학","전공기초필수"], tags:["#공대","#MSC","#전공기초필수"]},

      {id:"14", q:"MSC 과목은 전공학점으로 인정?", a:"아니요. 미분적분학·일반화학및실험·일반물리학및실험 등은 전공학점 불인정(총졸업학점만).", kw:["MSC","미분적분학","일반화학및실험","일반물리학및실험"], tags:["#MSC","#졸업요건"]},
      {id:"15", q:"MSC 과목 목록은?", a:"미분적분학, 일반화학및실험, 일반물리학및실험 관련 과목입니다.", kw:["MSC","과목 목록"], tags:["#MSC"]},
      {id:"16", q:"공대/자연대 주전공자가 1학년 MSC 수강 시?", a:"전공학점이 아니라 전체 졸업학점으로만 인정됩니다.", kw:["공대","자연대","MSC"], tags:["#MSC","#졸업요건"]},

      {id:"17", q:"1학년 교양필수 학점은?", a:"(2025학번) 공통 교양필수 35학점입니다.", kw:["교양필수","1학년","35학점"], tags:["#교양필수","#1학년"]},
      {id:"18", q:"핵심교양·사회봉사·커리어개발2 기준은?", a:"핵심교양 4, 사회봉사 1, 커리어개발2 1학점.", kw:["핵심교양","사회봉사","커리어개발2"], tags:["#교양필수"]},
      {id:"19", q:"커리어개발2는 어디 개설 과목 들어야 하나요?", a:"선택한 주전공 학부(과) 개설 과목(3학년 2학기)으로 이수합니다.", kw:["커리어개발2","주전공 학과"], tags:["#커리어개발","#교양필수"]},
      {id:"20", q:"교양필수 F 받으면?", a:"졸업 전 반드시 재수강해 학점 취득해야 합니다.", kw:["교양필수","F","재수강"], tags:["#교양필수","#졸업요건"]},
      {id:"21", q:"1학년 공통 교과 예시는?", a:"Systems/Design Thinking, Make Core, ACD Thinking, Calculus in Context, Unified Systems Science, Global Critical Anthropology, Life Project 등.", kw:["공통교과","Systems Thinking","Life Project"], tags:["#1학년","#교양필수"]},

      {id:"22", q:"주전공 신청 자격(2025학번)?", a:"신청 학기 재학 중 + 주전공 확정 시 누평 2.0 이상.", kw:["주전공","자격","누평2.0"], tags:["#주전공","#성적"]},
      {id:"23", q:"1학년 F 있어도 주전공 신청 가능?", a:"가능. 다만 F 교양필수는 졸업 전 재수강 필수.", kw:["F","주전공","교양필수"], tags:["#성적","#주전공"]},
      {id:"24", q:"주전공 선발 방식은?", a:"자격 충족 시 전원 선발, 계열 제한 없이 자유 선택.", kw:["전원선발","자유선택"], tags:["#주전공","#선발"]},
      {id:"25", q:"주전공 선택/변경 횟수는?", a:"총 2회(2학기 중 최초 선택 + 졸업 전 1회 변경).", kw:["주전공 변경","2회"], tags:["#주전공","#변경"]},
      {id:"26", q:"선택 불가 학과는?", a:"의과대학, 간호, 사범, 음악, 예술·체육, 반도체공학과(계약학과).", kw:["선택불가","의대","반도체공학"], tags:["#제한전공"]},

      {id:"27", q:"부전공은 필수인가요?", a:"네. 한양인터칼리지 재학생은 부전공 이상 1개 필수.", kw:["부전공 필수"], tags:["#부전공","#프로그램"]},
      {id:"28", q:"일반학과 주전공-일반학과 다전공만으로 졸업 가능?", a:"불가. 반드시 한양인터칼리지 프로그램 부/다중전공 1개 이상 이수.", kw:["프로그램 필수"], tags:["#부전공","#프로그램"]},
      {id:"29", q:"주전공 최소 전공학점은?", a:"최소 48학점 이수.", kw:["전공학점48"], tags:["#주전공","#졸업요건"]},
      {id:"30", q:"일반 다중전공 기준은?", a:"(건축 제외) 36학점 이상: 200~300단위 21 + 400단위 6 포함.", kw:["다중전공36","400단위6"], tags:["#다중전공"]},
      {id:"31", q:"건축학부 다중전공 기준은?", a:"100~300단위 60 + 400단위 18 → 총 100학점 이상.", kw:["건축 다중전공","100학점"], tags:["#다중전공","#건축"]},
      {id:"32", q:"프로그램 다중전공 기준은?", a:"지정 과목 36학점 이상(400단위 6 포함).", kw:["프로그램 다중","36학점"], tags:["#다중전공","#프로그램"]},
      {id:"33", q:"부전공 학점 기준은?", a:"일반 21(200~400단위 12 포함) / 프로그램 24(단위 구분 없음).", kw:["부전공21","프로그램24"], tags:["#부전공","#프로그램"]},
      {id:"34", q:"부전공 대신 다중전공 가능?", a:"가능. 다중전공으로 졸업요건 충족 가능.", kw:["부전공 대체"], tags:["#다중전공","#부전공"]},
      {id:"35", q:"마이크로전공으로 프로그램 부전공 대체?", a:"불가. 마이크로전공(12학점)은 대체 불가.", kw:["마이크로전공12"], tags:["#마이크로전공","#부전공"]},
      {id:"36", q:"프로그램을 주전공으로 선택 시 추가 전공 필요?", a:"네. 타 단과대 전공 또는 다른 프로그램을 부전공 이상으로 추가.", kw:["프로그램 주전공"], tags:["#주전공","#부전공","#프로그램"]},

      {id:"37", q:"학위 표기는 어떻게 되나요?", a:"주전공 단과대/학부 명칭으로 수여, 부·다전공은 졸업증명서에 표기.", kw:["학위 표기"], tags:["#졸업요건"]},
      {id:"38", q:"전공 400단위 최소 이수는?", a:"주전공 기준 400단위 6학점 이상.", kw:["400단위6"], tags:["#전공학점","#졸업요건"]},
      {id:"39", q:"4학년 프로젝트 학점(한양IC 주전공)은?", a:"12학점 필수이지만 전공학점에는 미포함(총졸업학점 반영).", kw:["4학년12","전공학점X"], tags:["#프로젝트","#전공학점"]},
      {id:"40", q:"4학년 프로젝트(타과 주전공)는?", a:"12학점 필수, 전공학점 미포함.", kw:["4학년12","타과"], tags:["#프로젝트"]},
      {id:"41", q:"총 졸업학점은?", a:"총 140학점.", kw:["졸업학점140"], tags:["#졸업요건"]},

      {id:"42", q:"전공설명회 수요조사 일정은?", a:"예: 2025.09.18~09.22 (최신 공지 확인).", kw:["전공설명회","수요조사"], tags:["#일정","#전공설명회"]},
      {id:"43", q:"전공설명회 본행사는?", a:"10월 예정(추후 공지).", kw:["전공설명회","10월"], tags:["#일정","#전공설명회"]},
      {id:"44", q:"주전공 선택 신청 기간은?", a:"예: 2025.10.30~11.05.", kw:["주전공 신청"], tags:["#일정","#주전공"]},
      {id:"45", q:"다중전공 선택 신청 기간은?", a:"예: 2025.11.10~11.14.", kw:["다중전공 신청"], tags:["#일정","#다중전공"]},
      {id:"46", q:"주전공/다중전공 확정 및 심의는?", a:"예: 2026.01 심의 후 확정.", kw:["심의 확정"], tags:["#일정","#주전공","#다중전공"]},

      {id:"47", q:"누적 평점 2.0 미만이면 불가?", a:"신청은 가능하나 최종 배정은 누평 2.0 이상 필요.", kw:["누평2.0"], tags:["#성적","#주전공"]},
      {id:"48", q:"F 있어도 졸업 가능?", a:"필수 과목 F는 재수강 후 취득해야 졸업 가능.", kw:["F 재수강"], tags:["#교양필수","#졸업요건"]},

      {id:"49", q:"검색 팁(MSC)", a:"“MSC, 미분적분학, 일반화학, 일반물리, 전공학점, 전공기초필수” 조합 추천.", kw:["검색 팁 MSC"], tags:["#MSC","#검색"]},
      {id:"50", q:"검색 팁(전공학점/전공기초필수)", a:"“전공학점 48, 전공기초필수, 400단위, 200~300단위” 키워드 추천.", kw:["검색 팁 전공"], tags:["#검색","#전공학점"]},

      {id:"51", q:"최종 판단 근거는?", a:"항상 최신 학교 공식 공지/규정을 우선합니다. 본 페이지는 참고용.", kw:["최종근거","공식공지"], tags:["#안내","#주의"]},
      {id:"52", q:"온라인 신청 절차는?", a:"학내 포털/공지 절차에 따릅니다. 포털 공지사항을 확인하세요.", kw:["신청 절차","온라인"], tags:["#일정","#절차"]}
    ];

    /* 태그 목록 */
    const allTags = Array.from(new Set(faqData.flatMap(x => x.tags))).sort((a,b)=>a.localeCompare(b,'ko'));

    /* DOM */
    const qInput    = document.getElementById('q');
    const searchForm= document.getElementById('searchForm');
    const clearBtn  = document.getElementById('clearBtn');
    const resultsEl = document.getElementById('results');
    const countEl   = document.getElementById('count');
    const tagBar    = document.getElementById('tagBar');
    const hideToggle= document.getElementById('hideToggle');

    /* 전역 숨김 모드 상태 (로컬 저장) */
    let HIDE_MODE = JSON.parse(localStorage.getItem('hideAnswers') || 'false');
    if (hideToggle) hideToggle.checked = HIDE_MODE;

    /* 태그 렌더 */
    const selectedTags = new Set();
    function renderTags(){
      tagBar.innerHTML = '';
      allTags.forEach(tag=>{
        const btn = document.createElement('button');
        btn.className = 'chip'; btn.type='button';
        btn.setAttribute('data-on', selectedTags.has(tag) ? 'true' : 'false');
        btn.textContent = tag;
        btn.addEventListener('click', ()=>{
          if(selectedTags.has(tag)){ selectedTags.delete(tag); btn.setAttribute('data-on','false'); }
          else { selectedTags.add(tag); btn.setAttribute('data-on','true'); }
          update();
        });
        tagBar.appendChild(btn);
      });
    }

    /* 검색/스코어링 */
    const normalize = s => (s ?? '').toString().toLowerCase().replace(/\s+/g,' ').trim();

    function scoreEntry(entry, query){
      const nq = normalize(query);
      if(!nq && selectedTags.size===0) return 1;
      if(![...selectedTags].every(t => entry.tags.includes(t))) return 0;
      if(!nq) return 1;
      let score = 0;
      const hay = normalize(entry.q + ' ' + entry.a + ' ' + entry.kw.join(' '));
      if(hay.includes(nq)) score += 6;
      entry.kw.forEach(k=>{
        const nk = normalize(k);
        if(nk === nq) score += 5;
        else if(nk.includes(nq) || nq.includes(nk)) score += 3;
      });
      nq.split(' ').forEach(tok=>{
        if(tok.length>1 && hay.includes(tok)) score += 1;
      });
      return score;
    }

    function highlight(text, query){
      const nq = normalize(query);
      if(!nq) return text;
      const esc = nq.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      try{ return text.replace(new RegExp(`(${esc})`,'gi'), '<span class="hl">$1</span>'); }
      catch{ return text; }
    }

    /* 렌더 */
    function render(list, query){
      resultsEl.innerHTML = '';
      if(list.length===0){
        resultsEl.innerHTML = `<div class="empty">결과가 없습니다. 검색어를 바꾸거나 태그 선택을 확인해 주세요.</div>`;
        countEl.textContent = '0';
        return;
      }
      countEl.textContent = String(list.length);

      for(const e of list){
        const card = document.createElement('article');
        card.className = 'card';
        card.id = `q${e.id}`;
        card.setAttribute('data-blur', HIDE_MODE ? 'true' : 'false');
        card.setAttribute('data-collapsed', HIDE_MODE ? 'false' : 'true');

        card.innerHTML = `
          <div class="qline">
            <span class="badge">Q${e.id}</span>
            <h3 class="qtext" style="cursor:pointer" aria-expanded="${HIDE_MODE ? 'true' : 'false'}">${highlight(e.q, query)}</h3>
            <span class="veil" role="button" title="답변 보기">👁 보기</span>
            <span class="reveal" role="button" title="접기/펼치기">${HIDE_MODE ? '' : '▾ 펼치기'}</span>
          </div>
          <div class="answer" aria-hidden="${HIDE_MODE ? 'false' : 'true'}">${highlight(e.a, query)}</div>
          <div class="tags">${e.tags.map(t=>`<span class="tag">${t}</span>`).join(' ')}</div>
        `;

        const answerEl = card.querySelector('.answer');
        const revealBtn = card.querySelector('.reveal');
        const veilBtn   = card.querySelector('.veil');
        const qtitle    = card.querySelector('.qtext');

        function syncCardView(){
          if (HIDE_MODE){
            card.setAttribute('data-blur','true');
            card.setAttribute('data-collapsed','false');
            answerEl.style.filter = 'blur(6px)';
            answerEl.style.maxHeight = 'none';
            if(revealBtn) revealBtn.style.display = 'none';
            if(veilBtn) veilBtn.style.display   = 'inline-flex';
            qtitle.setAttribute('aria-expanded','true');
            answerEl.setAttribute('aria-hidden','false');
          } else {
            card.setAttribute('data-blur','false');
            if(veilBtn) veilBtn.style.display   = 'none';
            if(revealBtn) revealBtn.style.display = 'inline-flex';
            answerEl.style.filter = 'none';
            const collapsed = card.getAttribute('data-collapsed') === 'true';
            answerEl.style.maxHeight = collapsed ? '0' : 'none';
            if(revealBtn) revealBtn.textContent = collapsed ? '▾ 펼치기' : '▴ 접기';
            qtitle.setAttribute('aria-expanded', collapsed ? 'false' : 'true');
            answerEl.setAttribute('aria-hidden', collapsed ? 'true' : 'false');
          }
        }
        syncCardView();

        function toggleAccordion(){
          if (HIDE_MODE) return;
          const collapsed = card.getAttribute('data-collapsed') === 'true';
          card.setAttribute('data-collapsed', collapsed ? 'false' : 'true');
          syncCardView();
        }
        qtitle.addEventListener('click', toggleAccordion);
        revealBtn?.addEventListener('click', toggleAccordion);

        veilBtn?.addEventListener('click', ()=>{
          answerEl.style.filter = 'none';
          veilBtn.style.display = 'none';
        });

        resultsEl.appendChild(card);
      }
    }

    function search(query){
      return faqData
        .map(e => ({entry:e, score:scoreEntry(e, query)}))
        .filter(r => r.score > 0)
        .sort((a,b)=> b.score - a.score)
        .map(r => r.entry);
    }

    function update(pushState=true){
      const q = qInput.value;
      const list = search(q);
      render(list, q);
      if(pushState){
        const url = new URL(location.href);
        if(q.trim()) url.searchParams.set('q', q.trim()); else url.searchParams.delete('q');
        if(selectedTags.size) url.searchParams.set('tags', [...selectedTags].join(','));
        else url.searchParams.delete('tags');
        if(HIDE_MODE) url.searchParams.set('hide','1'); else url.searchParams.delete('hide');
        history.replaceState(null,'',url.toString());
      }
    }

    /* 초기화 & 이벤트 */
    function initFromQuery(){
      const params = new URLSearchParams(location.search);
      const q = params.get('q') || '';
      qInput.value = q;
      const tagQuery = params.get('tags');
      if(tagQuery){ tagQuery.split(',').forEach(t=> selectedTags.add(t)); }
      if(params.get('hide') === '1'){ HIDE_MODE = true; if(hideToggle) hideToggle.checked = true; }
    }

    initFromQuery();
    renderTags();
    update(false);

    searchForm.addEventListener('submit', (e)=>{ e.preventDefault(); update(); });
    qInput.addEventListener('input', ()=> update());
    clearBtn.addEventListener('click', ()=>{
      qInput.value = '';
      selectedTags.clear();
      renderTags();
      update();
    });

    hideToggle?.addEventListener('change', ()=>{
      HIDE_MODE = hideToggle.checked;
      localStorage.setItem('hideAnswers', JSON.stringify(HIDE_MODE));
      update(false);
    });

    // 키보드 단축키: '/' 누르면 검색창 포커스
    window.addEventListener('keydown', (e)=>{
      if(e.key === '/' && !e.target.matches('input, textarea')){
        e.preventDefault(); qInput.focus();
      }
    });

    if(location.hash){
      const el = document.querySelector(location.hash);
      if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
    }
  </script>
</body>
</html>
